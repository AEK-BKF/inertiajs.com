import Layout from '../components/Layout'

export default Layout
export const meta = { title: 'Local state caching' }

# Local state caching

## Vue.js

When navigating browser history, Inertia reloads pages using prop data cached in history state. Inertia does not, however, cache local component state, since this is beyond its reach. This can lead to outdated pages in your browser history. For example, if a user partially completes a form, then navigates away, and then returns back, the form will be reset and their work will have been lost.

To mitigate this issue, you can use the `remember` property to tell Inertia which local component state to cache. To do this, provide an array of keys that correspond to your component's data.

```js
{
  remember: {
    data: ['form'],
  },
  data() {
    return {
      form: {
        first_name: null,
        last_name: null,
        // ...
      },
    }
  },
}
```

If your page contains multiple components using the remember functionality, you'll need to provide a unique key for each component. For example, `Users/Create`. If you have multiple instances of the same component on the page, be sure to include a unique identifier for each of those instances. For example, `Users/Edit:{id}`.

```js
{
  remember: {
    data: ['form'],
    key: () => `Users/Edit:${this.user.id}`,
  },
  data() {
    return {
      form: {
        first_name: this.user.first_name,
        last_name: this.user.last_name,
        // ...
      },
    }
  },
}
```

You can also shortform the remember values:

```js
{
  // array of data keys
  remember: ['form'],

  // single data key
  remember: 'form',
}
```

## React

When navigating browser history, Inertia reloads pages using prop data cached in history state. Inertia does not, however, cache local component state, since this is beyond its reach. This can lead to outdated pages in your browser history. For example, if a user partially completes a form, then navigates away, and then returns back, the form will be reset and their work will have been lost.

To mitigate this issue, you can use the `useRememberedState` hook to tell Inertia which local component state to cache.

```jsx
import { useRememberedState } from 'inertia-react'
import React from 'react'

export default function Profile() {
  const [formState, setFormState] = useRememberedState({
    first_name: null,
    last_name: null,
    // ...
  })

  // ...
}
```

If your page contains multiple components using the remember functionality, you'll need to provide a unique key for each component. For example, `Users/Create`. If you have multiple instances of the same component on the page, be sure to include a unique identifier for each of those instances. For example, `Users/Edit:{id}`.

```jsx
import { useRememberedState } from 'inertia-react'
import React from 'react'

export default function Profile() {
  const [formState, setFormState] = useRememberedState(
    {
      first_name: props.user.first_name,
      last_name: props.user.last_name,
      // ...
    },
    `Users/Edit:${props.user.id}`
  )

  // ...
}
```

## Svelte

When navigating browser history, Inertia reloads pages using prop data cached in history state. Inertia does not, however, cache local component state, since this is beyond its reach. This can lead to outdated pages in your browser history. For example, if a user partially completes a form, then navigates away, and then returns back, the form will be reset and their work will have been lost.

To mitigate this issue, you can use the `remember` store to tell Inertia.js which local component state to cache.

```html
<script>
  import { Inertia, remember } from 'inertia-svelte'

  let form = remember({
    first_name: null,
    last_name: null,
  })
</script>

<form on:submit|preventDefault={() => Inertia.post('/contact', $form)}>
  <label for="first_name">First Name:</label>
  <input id="first_name" bind:value={$form.first_name}></div>

  <label for="last_name">Last name:</label>
  <input id="last_name" bind:value={$form.last_name}></div>

  <button type="submit">Save</button>
</form>
```

> `remember` returns a store. Prefix the variable you assign it to with `$` to take advantage of [auto-subscription](https://svelte.dev/tutorial/auto-subscriptions).

If your page contains multiple components using the remember functionality, you'll need to provide a unique key for each component. For example, `Users/Create`. If you have multiple instances of the same component on the page, be sure to include a unique identifier for each of those instances. For example, `Users/Edit:{id}`.

```js
<script>
  import { Inertia, page, remember } from 'inertia-svelte'

  $: ({ user } = $page)

  let form = remember({
    first_name: null,
    last_name: null,
  }, `Users/Edit:${user.id}`)

  // ...
</script>
```
