import dedent from 'dedent'
import Layout from '../components/Layout'
import TabbedCodeExamples from '../components/TabbedCodeExamples'

export default Layout
export const meta = {
    title: 'Shared data',
    hero: true,
    links: [
        { url: '#sharing-data', name: 'Sharing data' },
        { url: '#accessing-shared-data', name: 'Accessing shared data' },
        { url: '#flash-messages', name: 'Flash messages' },
    ],
}

# Shared data

Sometimes need to access certain data on numerous pages within your application. For example, a common use-case for this is showing the current user in the site header. Passing this data manually in each response isn't practical. In these situations shared data can be useful.

## Sharing data

The server-side adapters provide a way to preassign shared data which each request. This is typically done outside of your controllers. Shared data will be automatically merged with the page props provided in your controller. <span className="bg-orange-200 px-1">Be sure to use this feature sparingly, since this data will be included with every response.</span>

<TabbedCodeExamples
  examples={[
    {
      name: 'Laravel',
      language: 'php',
      code: dedent`
        // Synchronously
        Inertia::share('app.name', Config::get('app.name'));\n
        // Lazily
        Inertia::share('auth.user', function () {
            if (Auth::user()) {
                return [
                    'id' => Auth::user()->id,
                    'first_name' => Auth::user()->first_name,
                    'last_name' => Auth::user()->last_name,
                ];
            }
        });
      `
    }
  ]}
/>

## Accessing shared data

Once you've shared the data server-side, you'll then be able to access it within your page components as props. Share data can even be accessed in non-page components, although not as props in those cases. Here's an example of how to do this in a layout component.

<TabbedCodeExamples
  examples={[
    {
      name: 'Vue',
      description: 'Access shared data using the $page property.',
      language: 'twig',
      code: dedent`
        <template>
          <main>
            <header>
              You are logged in as: {{ $page.auth.user.name }}\n
              <nav>
                <inertia-link href="/">Home</inertia-link>
                <inertia-link href="/about">About</inertia-link>
                <inertia-link href="/contact">Contact</inertia-link>
              </nav>
            </header>\n
            <article>
              <slot />
            </article>
          </main>
        </template>
      `
    },
    {
      name: 'React',
      description: 'Access shared data using the usePageProps() hook.',
      language: 'jsx',
      code: dedent`
        import { InertiaLink, usePageProps } from 'inertia-react'
        import React from 'react'\n
        export default function Layout({ children }) {
          const { auth } = usePageProps()\n
          return (
            <main>
              <header>
                You are logged in as: {auth.user.name}\n
                <nav>
                  <InertiaLink href="/">Home</InertiaLink>
                  <InertiaLink href="/about">About</InertiaLink>
                  <InertiaLink href="/contact">Contact</InertiaLink>
                </nav>
              </header>\n
              <article>{children}</article>
            </main>
          )
        }
      `
    }
  ]}
/>

## Flash messages

<div className="my-8 px-8 py-3 text-orange-900 text-base font-medium bg-orange-200 rounded-r border-l-4 border-orange-400">This section is still being developed.</div>
